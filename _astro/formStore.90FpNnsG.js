let u=[],a=(n,e)=>{let l=[],t={get(){return t.lc||t.listen(()=>{})(),t.value},l:e||0,lc:0,listen(i,f){return t.lc=l.push(i,f||t.l)/2,()=>{let r=l.indexOf(i);~r&&(l.splice(r,2),t.lc--,t.lc||t.off())}},notify(i){let f=!u.length;for(let r=0;r<l.length;r+=2)u.push(l[r],t.value,i,l[r+1]);if(f){for(let r=0;r<u.length;r+=4){let c=!1;for(let s=r+7;s<u.length;s+=4)if(u[s]<u[r+3]){c=!0;break}c?u.push(u[r],u[r+1],u[r+2],u[r+3]):u[r](u[r+1],u[r+2])}u.length=0}},off(){},set(i){t.value!==i&&(t.value=i,t.notify())},subscribe(i,f){let r=t.listen(i,f);return i(t.value),r},value:n};return t};function h(n,e){let l=v(e),t=n;for(let i of l){if(t===void 0)break;t=t[i]}return t}function g(n,e,l){return d(n??{},v(e),l)}function d(n,e,l){let t=e[0];p(n,t,e[1]);let i=Array.isArray(n)?[...n]:{...n};if(e.length===1)return l===void 0?Array.isArray(n)?i.splice(t,1):delete i[t]:i[t]=l,i;let f=d(n[t],e.slice(1),l);return n[t]=f,n}const o=/(.*)\[(\d+)\]/;function v(n){return n.split(".").flatMap(e=>o.test(e)?e.match(o).slice(1):[e])}function p(n,e,l){if(e in n)return;let t=parseInt(l??"");Number.isNaN(t)?n[e]={}:n[e]=Array(t+1).fill(void 0)}function A(n={}){let e=a(n);return e.setKey=(l,t)=>{h(e.value,l)!==t&&(e.value=g(e.value,l,t),e.notify(l))},e}let y=(n={})=>{let e=a(n);return e.setKey=function(l,t){typeof t>"u"?l in e.value&&(e.value={...e.value},delete e.value[l],e.notify(l)):e.value[l]!==t&&(e.value={...e.value,[l]:t},e.notify(l))},e};const m=a(!1),N=A({loadingDictionary:{}});y({success:!0,text:"",active:!1});export{a,m as b,N as l};
